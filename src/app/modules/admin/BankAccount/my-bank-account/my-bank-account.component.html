<div class="card-container">
  <div class="bank-card" *ngFor="let account of accounts">
    <div class="card-main-content">
      <!-- Informations principales -->
      <div class="card-content">
        <div class="card-header">
          <div class="account-details">
            <div class="account-type">Compte {{ account.typeBankAccount }}</div>
            <div class="account-number">{{ account.accountNumber | formatAccountNumber }}</div>
          </div>
          <i class="pi pi-wallet"></i>
        </div>

        <div class="user-name">{{ account.userFirstName }} {{ account.userLastName }}</div>
        <div class="account-balance">{{ account.balance | number:'1.2-2' }} DT</div>
      </div>

      <!-- Bloc d'alerte personnalisée -->
      <div class="alert-card" *ngIf="account.isBlocked">
        <div class="custom-card-warning">
          <!-- Header -->
          <div class="custom-card-header">
            <i class="pi pi-exclamation-triangle" style="color: red; font-size: 1.5rem;"></i>
            <span class="ml-2">Alerte de sécurité</span>
          </div>

          <!-- Body -->
          <div class="custom-card-body">
            <div class="alert-message">
              Ce compte a été <strong>bloqué</strong> en raison de <strong>transactions suspectes</strong>.
            </div>
          </div>

          <!-- Footer -->
          <div class="custom-card-footer flex justify-content-end">
            <button pButton type="button" label="Faire une réclamation" icon="pi pi-envelope"
                    class="p-button-danger"
                    (click)="openReclamation()">
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Tableau des transactions -->
<div class="transactions-table-wrapper">
  <p-table #dt class="custom-pagination-style custom-datatable-sm p-datatable-sm"
           [value]="recentTransactions"
           [tableStyle]="{ 'min-width': '10rem' }">

    <ng-template pTemplate="header">
      <tr class="custom-header">
        <th class="header-cell">Réf transaction</th>
        <th class="header-cell">Montant</th>
        <th class="header-cell">Devise</th>
        <th class="header-cell">Pays</th>
        <th class="header-cell">Date</th>
        <th class="header-cell">Type</th>
        <th class="header-cell">Statut</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-transaction>
      <tr>
        <td>#00TN{{ transaction.transactionId }}</td>
        <td>{{ transaction.amount }}</td>
        <td>{{ transaction.currency }}</td>
        <td>{{ transaction.country }}</td>
        <td>{{ transaction.transactionDate | date: 'dd/MM/yyyy' }}</td>
        <td>{{ transaction.typeTransaction }}</td>
        <td>
          <p-tag
            [value]="transaction.transactionStatus"
            [severity]="getSeverity(transaction.transactionStatus)"
            [icon]="getIcon(transaction.transactionStatus)">
          </p-tag>
        </td>
      </tr>
    </ng-template>

  </p-table>
</div>
